angular.module("app").controller("selectedLocationController",["$scope","$http","$stateParams","configurationService","fieldbookService","searchBarService","$state",function(e,a,o,t,i,r,c){e.location=o.ubicacion,e.locationInfo,e.fieldBookData={},e.isMobile=window.innerWidth<=600||window.innerHeight<=500,e.loadComplete=!1,e.clientsShown,e.noResults,e.showProducts=!1,e.showStores=!1,e.callPerformed=function(a){"mobile"===t.general.appType&&ga_storage._trackEvent("Llamadas",a.toLowerCase(),e.searchText.toLowerCase())},e.locationConsulted=function(a){"mobile"===t.general.appType&&ga_storage._trackEvent("Ubicaciones",a.toLowerCase(),e.searchText.toLowerCase())},e.logoPressed=function(){document.getElementById("searchterm").focus()},e.search=function(a,o){document.getElementById("content").scrollTop=0,document.getElementById("searchterm").blur(),e.clientsShown=r.getMatches(e.fieldBookData,a,o),e.noResults=r.noResults(e.clientsShown);var i=document.getElementById("searchBox");document.getElementById("searchterm");i.style.display="none",i.className="nav-up",e.searchText=a,e.currentSearch=a,e.noResults?("web"===t.general.appType?ga("send","pageview","search?searchText="+a.toLowerCase()+" (Not Found)"):"mobile"===t.general.appType&&ga_storage._trackPageview("mobileSearch?searchText="+a.toLowerCase()+" (Not Found)","No Results Mobile Search"),c.go("selectedLocation.sinResultados")):("web"===t.general.appType?ga("send","pageview","search?searchText="+a.toLowerCase()):"mobile"===t.general.appType&&ga_storage._trackPageview("mobileSearch?searchText="+a.toLowerCase(),"Mobile Search"),c.go("selectedLocation.resultados")),"mobile"===t.general.appType&&ga_storage._trackEvent("Busquedas",e.noResults?"Sin resultados":"Exitosas",a.toLowerCase())};var s=function(e){outputData={},outputData.productos={},outputData.clientes={},outputData.productos.listaDeCategoriasSinRepetir=[],outputData.productos.categoriasConArticulos=[];for(var a in e.allProducts){var o=e.allProducts[a].categoria[0].nombre,t=e.allProducts[a].producto;categoriaModificada=o.toLowerCase().trim().replace(new RegExp(/[àáâãäå]/g),"a").replace(new RegExp(/[èéêë]/g),"e").replace(new RegExp(/[ìíîï]/g),"i").replace(new RegExp(/[òóôõö]/g),"o").replace(new RegExp(/[ùúûü]/g),"u"),categoriaModificada=categoriaModificada.charAt(0).toUpperCase()+categoriaModificada.slice(1);var i=outputData.productos.listaDeCategoriasSinRepetir.indexOf(categoriaModificada);-1==i?(outputData.productos.listaDeCategoriasSinRepetir.push(categoriaModificada),outputData.productos.categoriasConArticulos.push({nombre:categoriaModificada,articulos:[t]})):(articuloModificado=t.toLowerCase().trim().replace(new RegExp(/[àáâãäå]/g),"a").replace(new RegExp(/[èéêë]/g),"e").replace(new RegExp(/[ìíîï]/g),"i").replace(new RegExp(/[òóôõö]/g),"o").replace(new RegExp(/[ùúûü]/g),"u"),articuloModificado=articuloModificado.charAt(0).toUpperCase()+articuloModificado.slice(1),outputData.productos.categoriasConArticulos[i].articulos.push(articuloModificado))}outputData.clientes.listaDeCategoriasSinRepetir=[],outputData.clientes.categoriasConArticulos=[];for(var a in e.allClients){e.allClients[a].categoria=e.allClients[a].categoria||"Otros";var o=e.allClients[a].categoria,r=e.allClients[a].cliente;categoriaModificada=o.toLowerCase().trim().replace(new RegExp(/[àáâãäå]/g),"a").replace(new RegExp(/[èéêë]/g),"e").replace(new RegExp(/[ìíîï]/g),"i").replace(new RegExp(/[òóôõö]/g),"o").replace(new RegExp(/[ùúûü]/g),"u"),categoriaModificada=categoriaModificada.charAt(0).toUpperCase()+categoriaModificada.slice(1);var i=outputData.clientes.listaDeCategoriasSinRepetir.indexOf(categoriaModificada);-1==i?(outputData.clientes.listaDeCategoriasSinRepetir.push(categoriaModificada),outputData.clientes.categoriasConArticulos.push({nombre:categoriaModificada,articulos:[r]})):outputData.clientes.categoriasConArticulos[i].articulos.push(r)}return console.log(e),console.log(outputData),outputData};!function(){var a=function(a){e.locationInfo=a,null!=a.sugerencias&&(a.sugerencias=a.sugerencias.split(","))};i.getRegions(function(o){for(reg in o)o[reg].nombre===e.location&&(a(o[reg]),i.getAllData(o[reg],function(a){e.fieldBookData=a,e.dataUtilities=s(a),e.loadComplete=!0}))})}()}]);